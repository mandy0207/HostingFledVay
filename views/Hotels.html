<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Baloo+Bhai+2:wght@500&display=swap" rel="stylesheet">
    <title>Hotels</title>
    <link rel="stylesheet" href="../static/style6.css">
</head>
<style>
    .hiddo {
        display: none;
    }
</style>

<body>
    <header class="text-gray-600 body-font navhead">
        <div class="container mx-auto flex flex-wrap p-4 flex-col md:flex-row items-center">
            <a class="flex title-font font-medium items-center text-gray-900 mb-3 md:mb-0">
                <img class="logo" src="../static/pics/logo.png" alt="logo">
                <span class="ml-3 text-xl anchor">FledVay</span>
            </a>
            <nav class="md:mr-auto md:ml-4 md:py-1 md:pl-4 md:border-l md:border-gray-400	flex flex-wrap items-center text-base justify-center">
                <a class="mr-12 text-black anchor" href="home">Home</a>
                <a class="mr-12 text-black anchor" href="about">About</a>
                <a class="mr-12 text-black anchor" href="tracking">Booking</a>
                <a class="mr-12 text-black anchor" href="rooms">Rooms</a>
                <a class="mr-12 text-black anchor">Pages</a>
                <a class="mr-12 text-black anchor" href="contact">Contact</a>
                <div class="dropdown">
                    <a href="home" class="mr-12 text-black anchor">Register</a>
                    <div class="dropdown-content">
                        <a href="Signup" class=" mr-12 dropdowntext text-black anchor">Signup</a>
                        <a href="Login" class="mr-12 dropdowntext text-black anchor">Login</a>
                    </div>

                </div>
        </div>
        </nav>

        </div>
    </header>

    <section class="text-gray-600 body-font">
        <div class="container px-5 py-24 mx-auto">

            <div class="flex flex-wrap -m-4">

                <% if (arra.length!=0) { %>
                    <% for(var i=0; i < arra.length; i++) { %>

                        <div class="lg:w-1/4 md:w-1/2 p-4 w-full">
                            <a class="block relative h-48 rounded overflow-hidden">
                                    <img alt="photo" class="object-cover object-center w-full h-full block" src="<%= arra[i].image %>">
                                </a>
                            <div class="mt-4 itemInfo">

                                <h2 class="text-gray-900 title-font text-lg font-medium">
                                    <%= arra[i].Name %>
                                </h2>
                                <h3 class="roomtext text-xs tracking-widest title-font mb-1">
                                    <%= arra[i].Destination %>
                                </h3>
                                <p class="mt-1 roomtext hiddo">
                                    <span> <%= arra[i].Address %> </span>
                                </p>
                                <p class="mt-1 roomtext hiddo">
                                    <span> <%= arra[i].Checkin %> </span>
                                </p>
                                <p class="mt-1 roomtext hiddo">
                                    <span> <%= arra[i].Checkout %> </span>
                                </p>
                                <span class="flex items-center">
                                    <svg fill="currentColor" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="w-4 h-4 text-indigo-500" viewBox="0 0 24 24">
                                      <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                                    </svg>
                                    <svg fill="currentColor" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="w-4 h-4 text-indigo-500" viewBox="0 0 24 24">
                                      <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                                    </svg>
                                    <svg fill="currentColor" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="w-4 h-4 text-indigo-500" viewBox="0 0 24 24">
                                      <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                                    </svg>
                                    <svg fill="currentColor" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="w-4 h-4 text-indigo-500" viewBox="0 0 24 24">
                                      <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                                    </svg>
                                    <svg fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="w-4 h-4 text-indigo-500" viewBox="0 0 24 24">
                                      <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                                    </svg>
                                    <span class="text-gray-600 ml-3">4 Reviews</span>
                                </span>
                                <input type="submit" class="btn bckg text-white details" id="btni" value="See Detail">

                            </div>
                        </div>


                        <% } %>
                            <%}
                              else {%>
                                <table class="table table-bordered table-dark" id="mytable">
                                    <tr>
                                        <td colspan="6">Ooops! No Hotel Found </td>
                                    </tr>
                                    <%}%>

                                </table>
            </div>
        </div>
    </section>
    <script>
        const addToCartBtn = document.getElementsByClassName('details');
        let items = [];
        for (let i = 0; i < addToCartBtn.length; i++) {
            addToCartBtn[i].addEventListener("click", EvenTlistener)

            function EvenTlistener(e) {
                // console.log((e.target.parentElement.children[0].textContent).trim());
                var url = '/AjaxDetails';
                let item = {
                    name: (e.target.parentElement.children[0].textContent).trim(),
                    destination: (e.target.parentElement.children[1].textContent).trim(),
                    address: (e.target.parentElement.children[2].textContent).trim(),
                    image: e.target.parentElement.parentNode.children[0].children[0].getAttribute('src')
                };

                localStorage.setItem("hotel", (e.target.parentElement.children[0].textContent).trim())
                localStorage.setItem("imagepath", e.target.parentElement.parentNode.children[0].children[0].getAttribute('src'))
                localStorage.setItem("checkin", (e.target.parentElement.children[3].textContent).trim().substr(0, 15))
                localStorage.setItem("checkout", (e.target.parentElement.children[4].textContent).trim().substr(0, 15))

                const xhr = new XMLHttpRequest();
                xhr.open('POST', url, true);

                xhr.onload = function() {
                    if (this.status === 200) {

                        document.body.innerHTML = this.responseText
                        const CartBtn = document.getElementsByClassName('details');
                        console.log(CartBtn);
                        for (let i = 0; i < CartBtn.length; i++) {
                            CartBtn[i].addEventListener("click", RoomBooking)

                            function RoomBooking(e) {
                                // console.log("mandy");
                                let dimension = e.target.parentElement.children[0].textContent;
                                let roomtype = e.target.parentElement.children[1].textContent;
                                let bed = e.target.parentElement.children[2].textContent;
                                let price = e.target.parentElement.children[3].textContent.substr(3, 6);
                                let roomimage = e.target.parentElement.parentNode.children[0].children[0].getAttribute('src');
                                localStorage.setItem("dimension", dimension);
                                localStorage.setItem("roomtype", roomtype);
                                localStorage.setItem("bed", bed);
                                localStorage.setItem("price", price);
                                localStorage.setItem("roomimage", roomimage);
                            }
                        }

                    } else
                        console.log("some error");

                }


                xhr.setRequestHeader("Content-type", "application/json");
                xhr.send(JSON.stringify(item));
            }

        }
    </script>




</body>

</html>